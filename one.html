<!doctype html>
<html lang="en">

<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title>Floor 1 — Indoor Navigation (Standalone)</title>
    <style>
        :root {
            --bg: #eef4fb;
            --card: #fff;
            --accent: #0b66d6;
            --muted: #516273;
            --path: #ff5252;
        }

        html,
        body {
            height: 100%;
            margin: 0;
            font-family: Inter, Arial, Roboto, sans-serif;
            background: var(--bg)
        }

        header {
            display: flex;
            align-items: center;
            padding: 10px;
            background: var(--card);
            box-shadow: 0 1px 4px rgba(0, 0, 0, 0.06);
            position: sticky;
            top: 0;
            z-index: 20
        }

        header h1 {
            margin: 0;
            font-size: 16px
        }

        #controls {
            margin-left: auto;
            display: flex;
            gap: 8px;
            align-items: center
        }

        #app {
            display: flex;
            gap: 12px;
            padding: 12px;
            min-height: calc(100vh - 64px)
        }

        #left {
            flex: 1
        }

        #map-wrap {
            background: var(--card);
            padding: 12px;
            border-radius: 10px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.06)
        }

        #sidebar {
            width: 380px;
            max-width: 42%;
            display: flex;
            flex-direction: column;
            gap: 12px
        }

        .panel {
            background: var(--card);
            padding: 12px;
            border-radius: 10px
        }

        .muted {
            color: var(--muted);
            font-size: 13px
        }

        svg {
            width: 100%;
            height: 78vh;
            touch-action: none;
            display: block
        }

        .room {
            fill: #e8f6ff;
            stroke: #154b78;
            stroke-width: 1.5;
            cursor: pointer
        }

        .room.highlight {
            stroke: #ff6b6b;
            stroke-width: 3;
            fill: #fff6f6
        }

        .corridor-line {
            stroke: #cfe6fb;
            stroke-width: 26;
            fill: none;
            stroke-linecap: round
        }

        #route {
            fill: none;
            stroke: var(--path);
            stroke-width: 12;
            stroke-linecap: round;
            stroke-linejoin: round
        }

        #routeOverlay {
            fill: none;
            stroke: transparent;
            stroke-width: 12
        }

        button,
        input,
        select {
            padding: 8px;
            border-radius: 8px;
            border: 1px solid #d6dae0;
            background: #fff;
            font-size: 14px
        }

        button.primary {
            background: var(--accent);
            color: #fff;
            border: none
        }

        #progressBar {
            height: 10px;
            background: #eee;
            border-radius: 8px;
            overflow: hidden;
            margin-top: 8px
        }

        #progressFill {
            height: 100%;
            width: 0;
            background: var(--accent);
            transition: width 0.18s linear
        }

        .controls-row {
            display: flex;
            gap: 8px;
            align-items: center
        }

        .small {
            font-size: 12px;
            color: var(--muted)
        }

        @media (max-width:900px) {
            #app {
                flex-direction: column
            }

            #sidebar {
                width: 100%
            }
        }
    </style>
</head>

<body>
    <header>
        <h1>Floor 1 — Indoor Navigation</h1>
        <div id="controls">
            <button id="rotLeft" title="Rotate left">⟲</button>
            <button id="rotRight" title="Rotate right">⟳</button>
            <button id="resetView">Reset</button>
            <input id="searchBox" placeholder="Search: LAB1, LH06, SH1..." />
            <button id="searchBtn">Search</button>
        </div>
    </header>

    <div id="app">
        <div id="left">
            <div id="map-wrap" class="panel">
                <!-- SVG with transformable group "viewport" -->
                <svg id="svg" viewBox="0 0 1000 1200" role="img" aria-label="Floor 1 map">
                    <defs>
                        <filter id="shadow" x="-50%" y="-50%" width="200%" height="200%">
                            <feDropShadow dx="0" dy="6" stdDeviation="6" flood-color="#000" flood-opacity="0.06" />
                        </filter>
                    </defs>

                    <g id="viewport">
                        <!-- Outer corridor ring (walkable) -->
                        <polyline class="corridor-line" points="160,180 840,180 840,820 160,820 160,180" />

                        <!-- central courtyard (not walkable) -->
                        <rect x="300" y="260" width="400" height="380" fill="#fbfdff" stroke="#eef3fb" />
                        <text x="500" y="450" font-size="18" text-anchor="middle" fill="#6b6b6b">Central
                            Courtyard</text>

                        <!-- TOP: Lab 1..4 and restroom (left→right) -->
                        <rect id="LAB1" class="room" x="180" y="80" width="150" height="70" /><text x="255" y="120"
                            font-size="12" text-anchor="middle">Lab 1</text>
                        <rect id="LAB2" class="room" x="340" y="80" width="150" height="70" /><text x="415" y="120"
                            font-size="12" text-anchor="middle">Lab 2</text>
                        <rect id="LAB3" class="room" x="500" y="80" width="150" height="70" /><text x="575" y="120"
                            font-size="12" text-anchor="middle">Lab 3</text>
                        <rect id="LAB4" class="room" x="660" y="80" width="150" height="70" /><text x="735" y="120"
                            font-size="12" text-anchor="middle">Lab 4</text>


                        <!-- FOUR corner stairs -->
                        <rect id="stair-NW" x="90" y="80" width="50" height="80" fill="#e8f2ff" stroke="#7aa6ff" />
                        <text x="115" y="120" font-size="10" text-anchor="middle">Stair</text>

                        <rect class="room" x="90" y="175" width="40" height="40" />
                        <text x="110" y="195" font-size="11" text-anchor="middle">water</text>

                        <rect id="stair-NE" x="860" y="80" width="50" height="80" fill="#e8f2ff" stroke="#7aa6ff" />
                        <text x="885" y="120" font-size="10" text-anchor="middle">Stair</text>

                        <rect class="room" x="860" y="200" width="40" height="40" />
                        <text x="880" y="220" font-size="11" text-anchor="middle">water</text>

                        <rect id="stair-SW" x="-10" y="850" width="50" height="80" fill="#e8f2ff" stroke="#7aa6ff" />
                        <text x="15" y="890" font-size="10" text-anchor="middle">Stair</text>

                        <rect class="room" x="80" y="775" width="40" height="40" />
                        <text x="100" y="800" font-size="11" text-anchor="middle">water</text>

                        <rect class="room" x="20" y="775" width="50" height="40" />
                        <text x="40" y="800" font-size="11" text-anchor="middle">filt</text>

                        <rect id="stair-SE" x="900" y="850" width="50" height="80" fill="#e8f2ff" stroke="#7aa6ff" />
                        <text x="925" y="890" font-size="10" text-anchor="middle">Stair</text>

                        <rect class="room" x="860" y="765" width="40" height="40" />
                        <text x="880" y="790" font-size="11" text-anchor="middle">water</text>

                        <!-- Top-right restroom near stair -->
                        <rect id="REST_TOP" class="room" x="940" y="100" width="80" height="60"
                            style="fill:#ffefef;stroke:#e04a4a" />
                        <text x="980" y="135" font-size="11" text-anchor="middle">Restroom</text>

                        <!-- LEFT side: Lab C, Lab B, Lab A (top→bottom) -->
                        <rect id="LABC" class="room" x="10" y="220" width="120" height="240" /><text x="75" y="350"
                            font-size="12" text-anchor="middle">Lab C</text>
                        <rect id="LABB" class="room" x="10" y="470" width="120" height="140" /><text x="75" y="550"
                            font-size="12" text-anchor="middle">Lab B</text>
                        <rect id="LABA" class="room" x="10" y="620" width="120" height="140" /><text x="75" y="690"
                            font-size="12" text-anchor="middle">Lab A</text>

                        <!-- RIGHT side: LH-6..LH-10 top→bottom -->
                        <rect id="LH06" class="room" x="860" y="245" width="80" height="90" />
                        <text x="900" y="300" font-size="11" text-anchor="middle">LH06</text>

                        <rect id="LH07" class="room" x="860" y="345" width="80" height="90" />
                        <text x="900" y="400" font-size="11" text-anchor="middle">LH07</text>

                        <rect id="LH08" class="room" x="860" y="445" width="80" height="90" />
                        <text x="900" y="500" font-size="11" text-anchor="middle">LH08</text>

                        <rect id="LH09" class="room" x="860" y="545" width="80" height="90" />
                        <text x="900" y="600" font-size="11" text-anchor="middle">LH09</text>

                        <rect id="LH10" class="room" x="860" y="645" width="80" height="90" />
                        <text x="900" y="700" font-size="11" text-anchor="middle">LH10</text>

                        <!-- BOTTOM: SH-1 | Staff Room | LH-14 | LH-13 (left→right) -->
                        <rect id="SH1" class="room" x="90" y="840" width="250" height="70" /><text x="200" y="875"
                            font-size="12" text-anchor="middle">SH-1</text>
                        <rect id="STAFF" class="room" x="360" y="840" width="200" height="70" /><text x="460" y="875"
                            font-size="12" text-anchor="middle">Staff Room</text>
                        <rect id="LH14" class="room" x="580" y="840" width="150" height="70" /><text x="655" y="875"
                            font-size="12" text-anchor="middle">LH-14</text>
                        <rect id="LH13" class="room" x="750" y="840" width="120" height="70" /><text x="810" y="875"
                            font-size="12" text-anchor="middle">LH-13</text>

                        <!-- route polyline (drawn dynamically) -->
                        <polyline id="route" points="" />
                        <polyline id="routeOverlay" points="" />
                    </g>
                </svg>
            </div>
        </div>

        <aside id="sidebar" class="panel">
            <div class="panel">
                <div class="muted">Start</div>
                <div style="font-weight:600;margin:6px 0">Entrance (South-center)</div>

                <div class="muted" style="margin-top:8px">Destination</div>
                <select id="destSelect" style="width:100%;margin-top:6px">
                    <option value="">-- choose destination --</option>
                    <option value="SH1">SH-1</option>
                    <option value="STAFF">Staff Room</option>
                    <option value="LH14">LH-14</option>
                    <option value="LH13">LH-13</option>
                    <option value="LH06">LH-06</option>
                    <option value="LH07">LH-07</option>
                    <option value="LH08">LH-08</option>
                    <option value="LH09">LH-09</option>
                    <option value="LH10">LH-10</option>
                    <option value="LAB1">Lab 1</option>
                    <option value="LAB2">Lab 2</option>
                    <option value="LAB3">Lab 3</option>
                    <option value="LAB4">Lab 4</option>
                    <option value="LABA">Lab A</option>
                    <option value="LABB">Lab B</option>
                    <option value="LABC">Lab C</option>
                    <option value="REST_TOP">Restroom</option>
                </select>

                <div style="display:flex;gap:8px;margin-top:10px">
                    <button id="startBtn" class="primary">Start Navigation</button>
                    <button id="clearBtn">Clear</button>
                </div>

                <div style="margin-top:12px" class="muted">Calibration & fallback</div>
                <label class="small">Avg step length (m)</label>
                <input id="stepLen" type="number" step="0.01" value="0.75" style="width:100%;margin-top:6px" />

                <div style="display:flex;gap:6px;margin-top:10px">
                    <button id="manualStep">Manual Step</button>
                    <button id="resetProgress">Reset</button>
                </div>
            </div>

            <div class="panel">
                <div class="muted">Status</div>
                <div style="margin-top:8px" class="controls-row">
                    <div class="small">Steps</div>
                    <div id="steps">0</div>
                </div>
                <div class="controls-row">
                    <div class="small">Distance travelled</div>
                    <div id="distTraveled">0.00 m</div>
                </div>
                <div class="controls-row">
                    <div class="small">Remaining</div>
                    <div id="distRemaining">0.00 m</div>
                </div>
                <div id="progressBar">
                    <div id="progressFill"></div>
                </div>
            </div>

            <div class="panel">
                <div class="muted">Instruction (voice + text)</div>
                <div id="instr" style="margin-top:8px;font-weight:700">No route</div>
            </div>
        </aside>
    </div>

    <footer style="padding:8px;text-align:center;color:var(--muted)">Open in Chrome (Android) for accelerometer support.
        Allow motion permission when prompted.</footer>

    <script>
        /* --------------------------
         Node coordinates and graph (corridor ring)
         Match coordinates used in SVG above
         ---------------------------*/
        const START = { x: 500, y: 920 }; // Entrance (south-center)
        const nodes = {
            // top row left->right
            N1: { x: 255, y: 160 }, N2: { x: 415, y: 160 }, N3: { x: 575, y: 160 }, N4: { x: 735, y: 160 },
            // top-right corner anchor
            NE: { x: 820, y: 220 },
            // right side anchors
            E1: { x: 860, y: 255 }, E2: { x: 860, y: 355 }, E3: { x: 860, y: 455 }, E4: { x: 860, y: 555 }, E5: { x: 860, y: 655 },
            // bottom row right->left
            S_E: { x: 760, y: 820 }, S2: { x: 655, y: 820 }, S1: { x: 455, y: 820 }, S_W: { x: 270, y: 820 },
            // left side anchors
            W3: { x: 180, y: 280 }, W2: { x: 180, y: 420 }, W1: { x: 180, y: 560 }
        };

        /* adjacency (clockwise around courtyard) + START -> S1 */
        const graph = {
            'START': ['S1'],
            'N1': ['N2', 'W1'], 'N2': ['N1', 'N3'], 'N3': ['N2', 'N4'], 'N4': ['N3', 'NE'],
            'NE': ['N4', 'E1'], 'E1': ['NE', 'E2'], 'E2': ['E1', 'E3'], 'E3': ['E2', 'E4'], 'E4': ['E3', 'E5'], 'E5': ['E4', 'S_E'],
            'S_E': ['E5', 'S2'], 'S2': ['S_E', 'S1'], 'S1': ['S2', 'S_W', 'START'], 'S_W': ['S1', 'W3'],
            'W3': ['S_W', 'W2'], 'W2': ['W3', 'W1'], 'W1': ['W2', 'N1']
        };

        /* POI -> nearest node mapping */
        const POI_NODE = {
            'LAB1': 'N1', 'LAB2': 'N2', 'LAB3': 'N3', 'LAB4': 'N4', 'REST_TOP': 'NE',
            'LABC': 'W3', 'LABB': 'W2', 'LABA': 'W1',
            'LH06': 'E1', 'LH07': 'E2', 'LH08': 'E3', 'LH09': 'E4', 'LH10': 'E5',
            'SH1': 'S_W', 'STAFF': 'S1', 'LH14': 'S2', 'LH13': 'S_E'
        };

        /* DOM */
        const svg = document.getElementById('svg');
        const viewport = document.getElementById('viewport');
        const route = document.getElementById('route');
        const routeOverlay = document.getElementById('routeOverlay');
        const destSelect = document.getElementById('destSelect');
        const instrEl = document.getElementById('instr');
        const stepsEl = document.getElementById('steps');
        const distTrEl = document.getElementById('distTraveled');
        const distRemEl = document.getElementById('distRemaining');
        const progressFill = document.getElementById('progressFill');

        const startBtn = document.getElementById('startBtn');
        const clearBtn = document.getElementById('clearBtn');
        const manualStepBtn = document.getElementById('manualStep');
        const resetBtn = document.getElementById('resetProgress');
        const searchBtn = document.getElementById('searchBtn');
        const searchBox = document.getElementById('searchBox');

        const rotLeft = document.getElementById('rotLeft');
        const rotRight = document.getElementById('rotRight');
        const resetView = document.getElementById('resetView');

        /* transform state */
        let state = { tx: 0, ty: 0, scale: 1, rotate: 0, dragging: false, lastX: 0, lastY: 0 };
        function applyTransform() { viewport.setAttribute('transform', `translate(${state.tx} ${state.ty}) scale(${state.scale}) rotate(${state.rotate} 500 500)`); }
        state.tx = 40; state.ty = 10; state.scale = 1; applyTransform();

        /* pan/zoom handlers */
        svg.addEventListener('pointerdown', (e) => { svg.setPointerCapture(e.pointerId); state.dragging = true; state.lastX = e.clientX; state.lastY = e.clientY; svg.style.cursor = 'grabbing'; });
        svg.addEventListener('pointermove', (e) => { if (!state.dragging) return; const dx = e.clientX - state.lastX, dy = e.clientY - state.lastY; state.lastX = e.clientX; state.lastY = e.clientY; state.tx += dx; state.ty += dy; applyTransform(); });
        svg.addEventListener('pointerup', (e) => { state.dragging = false; try { svg.releasePointerCapture(e.pointerId); } catch (e) { } svg.style.cursor = 'grab'; });
        svg.addEventListener('pointerleave', () => state.dragging = false);
        svg.addEventListener('wheel', (e) => { e.preventDefault(); if (e.shiftKey) { state.rotate += e.deltaY > 0 ? 3 : -3; } else { const delta = -e.deltaY * 0.0015; state.scale = Math.min(3, Math.max(0.4, state.scale * (1 + delta))); } applyTransform(); }, { passive: false });
        rotLeft.addEventListener('click', () => { state.rotate -= 15; applyTransform(); });
        rotRight.addEventListener('click', () => { state.rotate += 15; applyTransform(); });
        resetView.addEventListener('click', () => { state.tx = 40; state.ty = 10; state.scale = 1; state.rotate = 0; applyTransform(); });

        /* routing */
        function findPath(start, end) {
            if (start === end) return [start];
            const q = [start], prev = { [start]: null };
            while (q.length) {
                const cur = q.shift();
                for (const nb of (graph[cur] || [])) {
                    if (prev[nb] !== undefined) continue;
                    prev[nb] = cur; q.push(nb);
                    if (nb === end) {
                        const out = [nb]; let p = cur; while (p !== null) { out.unshift(p); p = prev[p]; } return out;
                    }
                }
            }
            return null;
        }
        function nodePos(k) { if (k === 'START') return START; return nodes[k]; }
        function pathToPoints(seq) { return seq.map(k => { const p = nodePos(k); return `${p.x} ${p.y}`; }).join(' '); }
        function polylineLength(points) { routeOverlay.setAttribute('points', points); try { return routeOverlay.getTotalLength(); } catch (e) { return 0; } }

        /* route state */
        let currentRoute = [], routePixelsTotal = 0, traveledPixels = 0, stepCount = 0, lastPeak = 0, lastSpokenIndex = 0;
        let pixelsPerMeter = 55;
        let avgStepMeters = parseFloat(document.getElementById('stepLen').value) || 0.75;

        function setRouteTo(destKey) {
            if (!POI_NODE[destKey]) { alert('Unknown dest'); return false; }
            const nodeKey = POI_NODE[destKey];
            const seq = findPath('START', nodeKey);
            if (!seq) { alert('No path'); return false; }
            currentRoute = seq.slice();
            const pts = pathToPoints(currentRoute);
            route.setAttribute('points', pts); routeOverlay.setAttribute('points', pts);
            routePixelsTotal = polylineLength(pts);
            traveledPixels = 0; stepCount = 0; lastSpokenIndex = 0;
            updateUI(); setRouteDash(0);
            const inst = makeInstructions(currentRoute);
            instrEl.textContent = inst[0]?.text || 'Follow the route';
            speak(inst[0]?.speech || inst[0]?.text || 'Follow the route');
            return true;
        }
        function setRouteDash(travelPx) {
            try { const total = routeOverlay.getTotalLength(); route.style.strokeDasharray = total; route.style.strokeDashoffset = Math.max(0, total - travelPx); } catch (e) { }
        }

        /* instructions builder */
        function makeInstructions(seq) {
            const out = []; if (!seq || seq.length < 2) return out;
            out.push({ text: 'Start at Entrance', speech: 'Start at entrance.' });
            for (let i = 1; i < seq.length; i++) {
                const a = nodePos(seq[i - 1]), b = nodePos(seq[i]);
                const dx = b.x - a.x, dy = b.y - a.y; const dist = Math.hypot(dx, dy);
                let dir = 'proceed';
                if (Math.abs(dx) > Math.abs(dy)) dir = dx > 0 ? 'proceed east' : 'proceed west';
                else dir = dy > 0 ? 'proceed south' : 'proceed north';
                const meters = Math.round((dist / pixelsPerMeter) * 100) / 100;
                out.push({ text: `${dir} for ${meters} m`, speech: `${dir} for ${meters} meters.` });
            }
            out.push({ text: 'You have arrived', speech: 'You have arrived at your destination.' });
            return out;
        }

        /* UI update */
        function updateUI() { stepsEl.textContent = stepCount; distTrEl.textContent = (stepCount * avgStepMeters).toFixed(2) + ' m'; const remain = Math.max(0, (routePixelsTotal - traveledPixels) / pixelsPerMeter).toFixed(2); distRemEl.textContent = remain + ' m'; const pct = routePixelsTotal ? Math.min(100, Math.round((traveledPixels / routePixelsTotal) * 100)) : 0; progressFill.style.width = pct + '%'; }

        /* motion / step detection */
        function motionHandler(ev) {
            const acc = ev.accelerationIncludingGravity || ev.acceleration || { x: 0, y: 0, z: 0 };
            const mag = Math.sqrt((acc.x || 0) ** 2 + (acc.y || 0) ** 2 + (acc.z || 0) ** 2);
            const g = 9.81; const val = Math.abs(mag - g);
            if (val > 1.1) {
                const now = Date.now();
                if (now - lastPeak > 300) {
                    lastPeak = now; stepCount++;
                    const px = (avgStepMeters || 0.75) * pixelsPerMeter;
                    traveledPixels += px; setRouteDash(traveledPixels); updateUI(); checkAndSpeak();
                    if (traveledPixels >= routePixelsTotal) arrive();
                }
            }
        }
        function arrive() { instrEl.textContent = 'Arrived'; speak('You have arrived at your destination'); stopMotion(); }

        /* speech */
        function speak(text) { if (!text) return; try { if ('speechSynthesis' in window) { const u = new SpeechSynthesisUtterance(text); u.lang = 'en-US'; window.speechSynthesis.cancel(); window.speechSynthesis.speak(u); } } catch (e) { } }

        /* start / stop motion */
        async function startMotion() {
            avgStepMeters = parseFloat(document.getElementById('stepLen').value) || 0.75;
            if (typeof DeviceMotionEvent !== 'undefined' && typeof DeviceMotionEvent.requestPermission === 'function') {
                try { const res = await DeviceMotionEvent.requestPermission(); if (res === 'granted') { window.addEventListener('devicemotion', motionHandler, { passive: true }); } else alert('Motion denied — use Manual Step'); } catch (e) { alert('Motion permission error — use Manual Step'); }
            } else window.addEventListener('devicemotion', motionHandler, { passive: true });
        }
        function stopMotion() { window.removeEventListener('devicemotion', motionHandler); }

        /* speak at segment thresholds */
        function checkAndSpeak() {
            if (!currentRoute || currentRoute.length < 2) return;
            let cum = 0; const thresholds = [];
            for (let i = 1; i < currentRoute.length; i++) { const a = nodePos(currentRoute[i - 1]), b = nodePos(currentRoute[i]); const d = Math.hypot(a.x - b.x, a.y - b.y); cum += d; thresholds.push(cum); }
            for (let i = 0; i < thresholds.length; i++) {
                if (traveledPixels >= thresholds[i] && lastSpokenIndex < i + 1) {
                    const inst = makeInstructions(currentRoute); const s = inst[i + 1] ? inst[i + 1].speech : ''; speak(s); lastSpokenIndex = i + 1;
                }
            }
        }

        /* UI wiring */
        startBtn.addEventListener('click', async () => {
            const dest = destSelect.value;
            if (!dest) { alert('Choose destination'); return; }
            if (!setRouteTo(dest)) return;
            instrEl.textContent = 'Navigation started'; await startMotion();
        });
        clearBtn.addEventListener('click', () => { route.setAttribute('points', ''); routeOverlay.setAttribute('points', ''); instrEl.textContent = 'No route'; traveledPixels = 0; stepCount = 0; updateUI(); });
        manualStepBtn.addEventListener('click', () => { stepCount++; const px = (avgStepMeters || 0.75) * pixelsPerMeter; traveledPixels += px; setRouteDash(traveledPixels); updateUI(); checkAndSpeak(); if (traveledPixels >= routePixelsTotal) arrive(); });
        resetBtn.addEventListener('click', () => { traveledPixels = 0; stepCount = 0; setRouteDash(0); updateUI(); instrEl.textContent = 'Progress reset'; });

        /* clickable rooms */
        document.querySelectorAll('.room').forEach(el => {
            el.addEventListener('click', () => {
                const id = el.id;
                if (POI_NODE[id]) { destSelect.value = id; el.classList.add('highlight'); setTimeout(() => el.classList.remove('highlight'), 900); }
            });
        });

        /* search */
        searchBtn.addEventListener('click', () => { const q = searchBox.value.trim().toUpperCase(); if (!q) return; const el = document.getElementById(q); if (el) { el.classList.add('highlight'); setTimeout(() => el.classList.remove('highlight'), 900); destSelect.value = q; } else alert('Not found: ' + q); });

        /* navigateTo API */
        window.navigateTo = function (name) { if (!name) return; const n = name.trim().toUpperCase(); if (POI_NODE[n]) { destSelect.value = n; setRouteTo(n); startMotion().catch(() => { }); } else alert('Unknown: ' + name); };

        /* initial state */
        updateUI();
    </script>
</body>

</html>
